import{A as v,G as Q,o as b,C as X,U as Z,w as ee,x as te,r as j,u as R,a as k,j as e,F as I,f as ae,b as z,d as se,e as le,D as ne,P as re,T as y,k as ie,l as oe,m as de,n as W,p as O,q as ce,s as ue,S as me,y as pe,z as xe,B as he,E as je,I as ge,H as fe,J as H,K as A,L as _,M as be,N as ve,O as ye,Q as q,V as B,W as V,X as M,Y as G,Z as D,_ as T,$ as E,a0 as Ce,a1 as we}from"./index-BlIzja95.js";import{D as Ne,R as De,T as Te,a as U}from"./ReportHeader-Ct-TsDPv.js";const Ee=t=>v.get("/employee/report/"+t+"/report"),Ie=t=>v.post("/employee/report",t),Oe=t=>v.delete("/employee/report/"+t),Re=t=>v.get("/employee/report/"+t),Pe=(t,a)=>v.patch("/employee/report/"+a,t),Se=t=>v.patch("/employee/report/complete/"+t),Le=(t,a)=>v.post("/employee/report/defect/"+a,t),P=t=>async a=>{try{const s=await Ee(t);a({type:Q+"_reports",payload:s.data.result})}catch(s){a(b({message:s.response.data.message,status:s.response.status}))}},J=t=>async a=>{try{const s=await Re(t);a({type:ee,payload:s.data.result})}catch(s){a(b({message:s.response.data.message,status:s.response.status}))}},L=t=>async a=>{try{const s=await Ie(t);a({type:X+"_reports",payload:s.data.result}),a(b({message:s.data.message,status:s.status}))}catch(s){a(b({message:s.response.data.message,status:s.response.status}))}},Fe=t=>async a=>{try{const s=await Oe(t);a({type:te+"_reports",payload:t}),a(b({message:s.data.message}))}catch(s){a(b({message:s.response.data.message,status:s.response.status}))}},ke=(t,a)=>async s=>{try{const r=await Pe(t,a);s({type:Z+"_reports",payload:a}),s(b({message:r.data.message,status:r.status}))}catch(r){s(b({message:r.response.data.message,status:r.response.status}))}},We=({getView:t,getEdit:a,getDelete:s,id:r})=>{const[x,c]=j.useState(null),[i,g]=j.useState(!1),m=R(f=>f.equipmentInfo)[0],o=k(),l=f=>{c(f)},p=()=>{c(null)};return e.jsxs("div",{className:"flex justify-center items-center gap-3",children:[e.jsx("p",{className:"flex justify-center items-center p-4 w-2 h-2 rounded-full bg-green-500 text-white cursor-pointer",onClick:async()=>{const f=await Se(r);o(P(m._id)),o(b({message:f.data.message}))},children:e.jsx(I,{icon:ae})}),e.jsx("p",{className:"flex justify-center items-center p-4 w-2 h-2 rounded-full bg-yellow-500 text-white cursor-pointer",onClick:()=>g(!0),children:e.jsx(I,{icon:z})}),e.jsx("p",{className:"flex justify-center items-center p-4 w-2 h-2 rounded-full bg-blue-600 text-white cursor-pointer",onClick:t,children:e.jsx(I,{icon:se})}),e.jsx("p",{className:"flex justify-center items-center p-4 w-2 h-2 rounded-full  bg-red-700 text-white cursor-pointer",onClick:()=>l(r),children:e.jsx(I,{icon:le})}),e.jsx(ne,{setStateClose:p,state:x===r,id:r,message:"Are You Sure To Delete ?",action:s},r),i&&e.jsx(Ne,{closeHandler:g,addHandler:Le,getAll:P,title:"Add Defect",formAction:"create",selected:null,reportId:r,equipmentId:m._id,defectLevel:m.defectLevel})]})},He=t=>{const a=k();return{getViewHandler:c=>{a(J(c)),t({action:"view",visible:!0})},getEditHandler:c=>{a(J(c)),t({action:"edit",visible:!0})},getDeleteHandler:async c=>{await a(Fe(c)),a(P())}}},Ae=({status:t})=>{const s={backgroundColor:(r=>{switch(r){case"Uncompleted":return"#D10000";case"Completed":return"#228B22";default:return"transparent"}})(t),paddingInline:"15px",paddingBlock:"10px",borderRadius:"5px",display:"inline-block"};return e.jsx("span",{style:s,children:t})},_e=({columns:t,rows:a,openForm:s})=>{const{getViewHandler:r,getEditHandler:x,getDeleteHandler:c}=He(s),[i,g]=j.useState(0),[m,o]=j.useState(10),[l,p]=j.useState(""),f=(d,h)=>{g(h)},C=d=>{o(+d.target.value),g(0)},S=a.filter(d=>Object.values(d).some(h=>String(h).toLowerCase().includes(l.toLowerCase())));return e.jsxs(re,{sx:{width:"100%",overflow:"hidden",marginTop:"3rem"},children:[e.jsx(y,{label:"Search",variant:"outlined",margin:"normal",value:l,onChange:d=>p(d.target.value)}),e.jsx(ie,{sx:{maxHeight:440},children:e.jsxs(oe,{children:[e.jsx(de,{children:e.jsxs(W,{children:[t.map(d=>e.jsx(O,{align:d.align,style:{minWidth:d.minWidth},children:d.label},d.id)),e.jsx(O,{align:"center",children:"Actions"})]})}),e.jsx(ce,{children:S.slice(i*m,i*m+m).map(d=>e.jsxs(W,{hover:!0,children:[t.map(h=>e.jsx(O,{align:h.align,children:h.id==="status"?e.jsx(Ae,{status:d[h.id]}):d[h.id]},h.id+d._id)),e.jsx(O,{children:e.jsx(We,{getView:()=>r(d._id),getEdit:()=>x(d._id),getDelete:()=>c(d._id),id:d._id})})]},d._id))})]})}),e.jsx(ue,{rowsPerPageOptions:[10,25,100],component:"div",count:a.length,rowsPerPage:m,page:i,onPageChange:f,onRowsPerPageChange:C})]})},qe=()=>v.get("/employee/workorder/DDL"),Be=j.forwardRef(function(a,s){return e.jsx(me,{direction:"up",ref:s,...a})}),F=({title:t,closeHandler:a,state:s,equipmentId:r,confirmHandler:x,selected:c,formAction:i,getAll:g})=>{const m={equipment:r,type:"",dateOfExamination:"",dateOfNextExamination:"",jobNumber:"",proofLoadApplied:"",foundDefectDangerToPerson:"",isImmediateDanger:!1,isPotentialDanger:!1,repairRenewalAlteration:"",testsCarriedOut:"",isFirstExamination:!1,isEquipmentInstalledCorrectly:!1,isEquipmentSafeToOperate:!1},{formData:o,errors:l,handleChange:p,handleSubmit:f,validateField:C,setFormData:S}=pe({selected:c,formAction:i,initialState:m,closeHandler:a,confirmHandler:x,schema:we,getAll:g}),[d,h]=j.useState([]);j.useEffect(()=>{(async()=>{try{const N=await qe();h(N.data.result)}catch(N){console.error("Error fetching list:",N)}})()},[o]);const w=n=>{const{name:N,checked:Y}=n.target;S(K=>({...K,[N]:Y}))};return e.jsxs(xe,{fullScreen:!0,open:s,onClose:a,TransitionComponent:Be,children:[e.jsx(he,{sx:{position:"relative"},children:e.jsxs(je,{children:[e.jsx(ge,{edge:"start",color:"inherit",onClick:a,"aria-label":"close",children:e.jsx(I,{icon:z})}),e.jsx(fe,{sx:{ml:2,flex:1},variant:"h6",component:"div",children:t})]})}),e.jsx("div",{className:"m-4",children:e.jsx("div",{className:"my-3",children:e.jsxs("form",{className:"w-full",onSubmit:f,children:[e.jsx("div",{className:"mb-4",children:e.jsxs(H,{fullWidth:!0,variant:"outlined",error:!!l.type,children:[e.jsx(A,{id:"type-label",children:"Type"}),e.jsx(_,{fullWidth:!0,labelId:"type-label",id:"type",name:"type",value:o.type,onChange:p,onBlur:n=>C(n.target.name,n.target.value),disabled:i==="view",label:"type",className:"w-full",children:[be,ve,ye].map(n=>e.jsx(q,{value:n.value,children:n.name},n.value))}),l.type&&e.jsx(B,{children:l.type})]})}),e.jsx("div",{className:"mb-4",children:e.jsx(V,{dateAdapter:M,children:e.jsx(G,{fullWidth:!0,label:"Date Of Examination",onChange:n=>p({target:{name:"dateOfExamination",value:n}}),renderInput:n=>e.jsx(y,{...n,value:o.dateOfExamination,fullWidth:!0,variant:"outlined",disabled:i==="view",error:!!l.dateOfExamination,helperText:l.dateOfExamination})})})}),e.jsx("div",{className:"mb-4",children:e.jsx(V,{dateAdapter:M,children:e.jsx(G,{fullWidth:!0,label:"Date Of Next Examination",onChange:n=>p({target:{name:"dateOfNextExamination",value:n}}),renderInput:n=>e.jsx(y,{...n,value:o.dateOfNextExamination,fullWidth:!0,variant:"outlined",disabled:i==="view",error:!!l.dateOfNextExamination,helperText:l.dateOfNextExamination})})})}),e.jsx("div",{className:"mb-4",children:e.jsxs(H,{fullWidth:!0,variant:"outlined",error:!!l.jobNumber,children:[e.jsx(A,{id:"jobNumber-label",children:"Job Number"}),e.jsx(_,{fullWidth:!0,labelId:"jobNumber-label",id:"jobNumber",name:"jobNumber",value:o.jobNumber,onChange:p,onBlur:n=>C(n.target.name,n.target.value),disabled:i==="view",label:"Job Number",className:"w-full",children:d.map(n=>e.jsx(q,{value:n._id,children:n.jobNumber},n._id))}),l.jobNumber&&e.jsx(B,{children:l.jobNumber})]})}),e.jsx("div",{className:"mb-4",children:e.jsx(y,{fullWidth:!0,label:"Proof Load Applied",name:"proofLoadApplied",type:"text",variant:"outlined",value:o.proofLoadApplied,onChange:p,onBlur:n=>C(n.target.name,n.target.value),disabled:i==="view",error:!!l.proofLoadApplied,helperText:l.proofLoadApplied})}),e.jsx("div",{className:"mb-4",children:e.jsx(y,{fullWidth:!0,label:"Found Defect Danger To Person",name:"foundDefectDangerToPerson",type:"text",variant:"outlined",value:o.foundDefectDangerToPerson,onChange:p,disabled:i==="view",helperText:"Leave it empty if has no defect"})}),e.jsxs("div",{className:"flex w-[30%] justify-between",children:[e.jsx("div",{className:"mb-4 w-fit",children:e.jsx(D,{children:e.jsx(T,{control:e.jsx(E,{checked:o.isImmediateDanger,onChange:w,name:"isImmediateDanger",color:"primary",disabled:i==="view"||!o.foundDefectDangerToPerson}),label:"Is Immediate Danger?"})})}),e.jsx("div",{className:"mb-4 w-fit",children:e.jsx(D,{children:e.jsx(T,{control:e.jsx(E,{checked:o.isPotentialDanger,onChange:w,name:"isPotentialDanger",color:"primary",disabled:i==="view"||!o.foundDefectDangerToPerson}),label:"Is Potential Danger?"})})})]}),e.jsx("div",{className:"mb-4",children:e.jsx(y,{fullWidth:!0,label:"Repair Renewal Alteration",name:"repairRenewalAlteration",type:"text",variant:"outlined",value:o.repairRenewalAlteration,onChange:p,disabled:i==="view"})}),e.jsx("div",{className:"mb-4",children:e.jsx(y,{fullWidth:!0,label:"Tests Carried Out",name:"testsCarriedOut",type:"text",variant:"outlined",value:o.testsCarriedOut,onChange:p,disabled:i==="view"})}),e.jsxs("div",{className:"flex w-[57%] justify-between",children:[e.jsx("div",{className:"mb-4 w-fit",children:e.jsx(D,{children:e.jsx(T,{control:e.jsx(E,{checked:o.isFirstExamination,onChange:w,name:"isFirstExamination",color:"primary",disabled:i==="view"}),label:"Is First Examination?"})})}),e.jsx("div",{className:"mb-4 w-fit",children:e.jsx(D,{children:e.jsx(T,{control:e.jsx(E,{checked:o.isEquipmentInstalledCorrectly,onChange:w,name:"isEquipmentInstalledCorrectly",color:"primary",disabled:i==="view"}),label:"Is Equipment Installed Correctly?"})})}),e.jsx("div",{className:"mb-4 w-fit",children:e.jsx(D,{children:e.jsx(T,{control:e.jsx(E,{checked:o.isEquipmentSafeToOperate,onChange:w,name:"isEquipmentSafeToOperate",color:"primary",disabled:i==="view"}),label:"Is Equipment Safe To Operate?"})})})]}),i!=="view"&&e.jsx(Ce,{type:"submit",variant:"contained",color:"primary",className:"w-full mt-2",children:i==="edit"?"Edit":"Add"})]})})})]})},Ve=[{id:"inspector",label:"Inspector",minWidth:170,align:"center"},{id:"reportName",label:"Report Name",minWidth:170,align:"center"},{id:"type",label:"Type",minWidth:170,align:"center"},{id:"status",label:"Status",minWidth:170,align:"center"},{id:"defectsCount",label:"Defects Count",minWidth:170,align:"center"},{id:"reportsCount",label:"Reports Count",minWidth:170,align:"center"},{id:"createdAt",label:"Created At",minWidth:170,align:"center"}],Me=({equipmentId:t})=>{const a=k(),s=R(l=>l.reports),r=R(l=>l.select),x=s.some(l=>l.status==="Uncompleted"),[c,i]=j.useState({visible:!1,action:"create"}),g=()=>{i(l=>({visible:!0,action:l.action}))},m=()=>{i(l=>({visible:!1,action:l.action}))};j.useEffect(()=>{a(P(t))},[a,t]);let o=e.jsx(F,{title:"Add New Report",state:c.visible,closeHandler:m,equipmentId:t,formAction:"create",confirmHandler:L});return c.action==="view"&&(o=e.jsx(F,{title:"View Report Details",state:c.visible,closeHandler:m,selected:r,equipmentId:t,formAction:"view",confirmHandler:L})),c.action==="edit"&&(o=e.jsx(F,{title:"Edit Report",state:c.visible,closeHandler:m,selected:r,equipmentId:t,formAction:"edit",confirmHandler:ke})),e.jsxs("div",{children:[e.jsx(De,{label:"Reports",confirmHandler:L,openFullForm:g,disabledAddReports:x}),c.visible&&o,e.jsx("main",{className:"flex justify-center items-center",children:s&&e.jsx(_e,{columns:Ve,rows:s,openForm:i})})]})},u=({title:t,value:a,className:s})=>e.jsxs("div",{className:"flex gap-4 w-[30%] pl-4 py-2 rounded-md "+s,children:[e.jsxs("div",{className:"font-bold",children:[t,":"]}),e.jsx("div",{style:{color:a?"inherit":"rgb(185 28 28)"},children:a||"None"})]}),$=({children:t,value:a,index:s,...r})=>e.jsx("div",{role:"tabpanel",hidden:a!==s,id:`simple-tabpanel-${s}`,"aria-labelledby":`simple-tab-${s}`,...r,children:a===s&&t}),Je=()=>{const t=R(x=>x.equipmentInfo)[0],[a,s]=j.useState(0),r=(x,c)=>{s(c)};return e.jsxs(e.Fragment,{children:[e.jsxs(Te,{value:a,onChange:r,"aria-label":"basic tabs example",children:[e.jsx(U,{label:"Equipment Info"}),e.jsx(U,{label:"Reports"})]}),e.jsxs($,{value:a,index:0,children:[e.jsxs("div",{className:"flex flex-wrap gap-8 mt-4",children:[e.jsx(u,{title:"Installation",value:t.installationName}),e.jsx(u,{title:"Serial Number",value:t.serialNumber}),e.jsx(u,{title:"Department",value:t.departmentName}),e.jsx(u,{title:"Category",value:t.categoryName}),e.jsx(u,{title:"Client",value:t.clientName}),e.jsx(u,{title:"Country",value:t.country}),e.jsx(u,{title:"Standard",value:t.standard[0].name}),e.jsx(u,{title:"Discription",value:t.discription})]}),e.jsx("hr",{className:"my-16"}),e.jsxs("div",{className:"flex flex-wrap gap-8 ",children:[e.jsx(u,{title:"Location",value:t.location}),e.jsx(u,{title:"Load Test Number",value:t.loadTestNumber}),e.jsx(u,{title:"SWL",value:t.swl}),e.jsx(u,{title:"Load Test Company",value:t.loadTestCompany}),e.jsx(u,{title:"Manufacturer",value:t.manufacturer}),e.jsx(u,{title:"Load Test Date",value:t.loadTestDate}),e.jsx(u,{title:"Manufacturer Date",value:t.manufacturerDate}),e.jsx(u,{title:"Date Of Last Inspection",value:t.dateOfLastInsp}),e.jsx(u,{title:"Main Serial Number",value:t.mainSerialNumber}),e.jsx(u,{title:"Date Of Next Inspection",value:t.dateOfNextInsp}),e.jsx(u,{title:"Last Inspector",value:t.lastInspectorName}),e.jsx(u,{title:"Last Inspector Number",value:t.lastInspectorNumber}),e.jsx(u,{title:"Comment",value:t.comment})]})]}),e.jsx($,{value:a,index:1,children:e.jsx("div",{className:"mt-4",children:e.jsx(Me,{equipmentId:t._id})})})]})};export{Je as default};
