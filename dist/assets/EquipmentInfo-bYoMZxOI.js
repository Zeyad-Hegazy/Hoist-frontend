import{r as x,u as b,a as y,j as e,c as F,g as R,o as P,F as f,f as A,b as H,d as k,e as L,D as O,h as E,i as W,P as _,T as V,k as q,l as B,m as M,n as T,p as g,q as U,s as $,R as C,t as N,v as Y}from"./index-BlIzja95.js";import{D as z,R as G,T as J,a as w}from"./ReportHeader-Ct-TsDPv.js";const K=({getView:t,getEdit:n,getDelete:l,id:i})=>{const[m,o]=x.useState(null),[d,h]=x.useState(!1),c=b(j=>j.equipmentInfo)[0],p=y(),r=j=>{o(j)},v=()=>{o(null)};return e.jsxs("div",{className:"flex justify-center items-center gap-3",children:[e.jsx("p",{className:"flex justify-center items-center p-4 w-2 h-2 rounded-full bg-green-500 text-white cursor-pointer",onClick:async()=>{const j=await F(i);p(R(c._id)),p(P({message:j.data.message}))},children:e.jsx(f,{icon:A})}),e.jsx("p",{className:"flex justify-center items-center p-4 w-2 h-2 rounded-full bg-yellow-500 text-white cursor-pointer",onClick:()=>h(!0),children:e.jsx(f,{icon:H})}),e.jsx("p",{className:"flex justify-center items-center p-4 w-2 h-2 rounded-full bg-blue-600 text-white cursor-pointer",onClick:t,children:e.jsx(f,{icon:k})}),e.jsx("p",{className:"flex justify-center items-center p-4 w-2 h-2 rounded-full  bg-red-700 text-white cursor-pointer",onClick:()=>r(i),children:e.jsx(f,{icon:L})}),e.jsx(O,{setStateClose:v,state:m===i,id:i,message:"Are You Sure To Delete ?",action:l},i),d&&e.jsx(z,{closeHandler:h,addHandler:E,getAll:R,title:"Add Defect",formAction:"create",selected:null,reportId:i,equipmentId:c._id,defectLevel:c.defectLevel})]})},Q=({status:t})=>{const l={backgroundColor:(i=>{switch(i){case"Uncompleted":return"#D10000";case"Completed":return"#228B22";default:return"transparent"}})(t),paddingInline:"15px",paddingBlock:"10px",borderRadius:"5px",display:"inline-block"};return e.jsx("span",{style:l,children:t})},X=({columns:t,rows:n,openForm:l})=>{const{getViewHandler:i,getEditHandler:m,getDeleteHandler:o}=W(l),[d,h]=x.useState(0),[c,p]=x.useState(10),[r,v]=x.useState(""),j=(a,u)=>{h(u)},I=a=>{p(+a.target.value),h(0)},S=n.filter(a=>Object.values(a).some(u=>String(u).toLowerCase().includes(r.toLowerCase())));return e.jsxs(_,{sx:{width:"100%",overflow:"hidden",marginTop:"3rem"},children:[e.jsx(V,{label:"Search",variant:"outlined",margin:"normal",value:r,onChange:a=>v(a.target.value)}),e.jsx(q,{sx:{maxHeight:440},children:e.jsxs(B,{children:[e.jsx(M,{children:e.jsxs(T,{children:[t.map(a=>e.jsx(g,{align:a.align,style:{minWidth:a.minWidth},children:a.label},a.id)),e.jsx(g,{align:"center",children:"Actions"})]})}),e.jsx(U,{children:S.slice(d*c,d*c+c).map(a=>e.jsxs(T,{hover:!0,children:[t.map(u=>e.jsx(g,{align:u.align,children:u.id==="status"?e.jsx(Q,{status:a[u.id]}):a[u.id]},u.id+a._id)),e.jsx(g,{children:e.jsx(K,{getView:()=>i(a._id),getEdit:()=>m(a._id),getDelete:()=>o(a._id),id:a._id})})]},a._id))})]})}),e.jsx($,{rowsPerPageOptions:[10,25,100],component:"div",count:n.length,rowsPerPage:c,page:d,onPageChange:j,onRowsPerPageChange:I})]})},Z=[{id:"inspector",label:"Inspector",minWidth:170,align:"center"},{id:"reportName",label:"Report Name",minWidth:170,align:"center"},{id:"type",label:"Type",minWidth:170,align:"center"},{id:"status",label:"Status",minWidth:170,align:"center"},{id:"defectsCount",label:"Defects Count",minWidth:170,align:"center"},{id:"reportsCount",label:"Reports Count",minWidth:170,align:"center"},{id:"createdAt",label:"Created At",minWidth:170,align:"center"}],ee=({equipmentId:t})=>{const n=y(),l=b(r=>r.reports),i=b(r=>r.select),m=l.some(r=>r.status==="Uncompleted"),[o,d]=x.useState({visible:!1,action:"create"}),h=()=>{d(r=>({visible:!0,action:r.action}))},c=()=>{d(r=>({visible:!1,action:r.action}))};x.useEffect(()=>{n(R(t))},[n,t]);let p=e.jsx(C,{title:"Add New Report",state:o.visible,closeHandler:c,equipmentId:t,formAction:"create",confirmHandler:N});return o.action==="view"&&(p=e.jsx(C,{title:"View Report Details",state:o.visible,closeHandler:c,selected:i,equipmentId:t,formAction:"view",confirmHandler:N})),o.action==="edit"&&(p=e.jsx(C,{title:"Edit Report",state:o.visible,closeHandler:c,selected:i,equipmentId:t,formAction:"edit",confirmHandler:Y})),e.jsxs("div",{children:[e.jsx(G,{label:"Reports",confirmHandler:N,openFullForm:h,disabledAddReports:m}),o.visible&&p,e.jsx("main",{className:"flex justify-center items-center",children:l&&e.jsx(X,{columns:Z,rows:l,openForm:d})})]})},s=({title:t,value:n,className:l})=>e.jsxs("div",{className:"flex gap-4 w-[30%] pl-4 py-2 rounded-md "+l,children:[e.jsxs("div",{className:"font-bold",children:[t,":"]}),e.jsx("div",{style:{color:n?"inherit":"rgb(185 28 28)"},children:n||"None"})]}),D=({children:t,value:n,index:l,...i})=>e.jsx("div",{role:"tabpanel",hidden:n!==l,id:`simple-tabpanel-${l}`,"aria-labelledby":`simple-tab-${l}`,...i,children:n===l&&t}),ae=()=>{const t=b(m=>m.equipmentInfo)[0],[n,l]=x.useState(0),i=(m,o)=>{l(o)};return e.jsxs(e.Fragment,{children:[e.jsxs(J,{value:n,onChange:i,"aria-label":"basic tabs example",children:[e.jsx(w,{label:"Equipment Info"}),e.jsx(w,{label:"Reports"})]}),e.jsxs(D,{value:n,index:0,children:[e.jsxs("div",{className:"flex flex-wrap gap-8 mt-4",children:[e.jsx(s,{title:"Installation",value:t.installationName}),e.jsx(s,{title:"Serial Number",value:t.serialNumber}),e.jsx(s,{title:"Department",value:t.departmentName}),e.jsx(s,{title:"Category",value:t.categoryName}),e.jsx(s,{title:"Client",value:t.clientName}),e.jsx(s,{title:"Country",value:t.country}),e.jsx(s,{title:"Standard",value:t.standard[0].name}),e.jsx(s,{title:"Discription",value:t.discription})]}),e.jsx("hr",{className:"my-16"}),e.jsxs("div",{className:"flex flex-wrap gap-8 ",children:[e.jsx(s,{title:"Location",value:t.location}),e.jsx(s,{title:"Load Test Number",value:t.loadTestNumber}),e.jsx(s,{title:"SWL",value:t.swl}),e.jsx(s,{title:"Load Test Company",value:t.loadTestCompany}),e.jsx(s,{title:"Manufacturer",value:t.manufacturer}),e.jsx(s,{title:"Load Test Date",value:t.loadTestDate}),e.jsx(s,{title:"Manufacturer Date",value:t.manufacturerDate}),e.jsx(s,{title:"Date Of Last Inspection",value:t.dateOfLastInsp}),e.jsx(s,{title:"Main Serial Number",value:t.mainSerialNumber}),e.jsx(s,{title:"Date Of Next Inspection",value:t.dateOfNextInsp}),e.jsx(s,{title:"Last Inspector",value:t.lastInspectorName}),e.jsx(s,{title:"Last Inspector Number",value:t.lastInspectorNumber}),e.jsx(s,{title:"Comment",value:t.comment})]})]}),e.jsx(D,{value:n,index:1,children:e.jsx("div",{className:"mt-4",children:e.jsx(ee,{equipmentId:t._id})})})]})};export{ae as default};
